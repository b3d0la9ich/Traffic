<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ü—Ä–æ–≥–Ω–æ–∑</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/predict.css') }}">
  <script defer src="{{ url_for('static', filename='js/theme-toggle.js') }}"></script>
</head>
<body>
  <div class="theme-toggle">
    <button id="toggle-theme">üåô</button>
  </div>

  <div class="predict-card">
    <h1>üìà –ü—Ä–æ–≥–Ω–æ–∑ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–ø–æ—Ç–æ–∫–∞</h1>

    {% with messages = get_flashed_messages(with_categories=true, category_filter=['pred_success','pred_warning','pred_danger']) %}
      {% if messages %}
        <div class="messages">
          {% for category, message in messages %}
            <div class="alert {{ category }}">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <form method="POST" class="form-vertical" autocomplete="on">
      <div class="field">
        <label for="year">–ì–æ–¥</label>
        <input id="year" type="number" name="year" min="2016" max="2030" required
               value="{{ request.form.get('year','') }}">
      </div>

      <div class="field">
        <label for="month">–ú–µ—Å—è—Ü</label>
        <input id="month" type="number" name="month" min="1" max="12" required
               value="{{ request.form.get('month','') }}">
      </div>

      <button type="submit" class="primary">–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑</button>
    </form>

    {% if prediction %}
      <div class="result">
        <h2>üîÆ –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ {{ request.form.get('year') }}-{{ "%02d"|format((request.form.get('month') or 1)|int) }}:
          <strong>{{ prediction | round }} –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤</strong>
        </h2>
      </div>
    {% endif %}

    {% if plot_url %}
      <div class="plot-card">
        <img src="data:image/png;base64,{{ plot_url }}" alt="–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥–Ω–æ–∑–∞">
      </div>
    {% endif %}

    <a class="back-link" href="{{ url_for('dashboard') }}">‚Üê –ù–∞–∑–∞–¥ –≤ –∫–∞–±–∏–Ω–µ—Ç</a>
  </div>
</body>
</html>
